<!doctype html>
<html lang="en" class="light-theme">
<head>
  <meta charset="utf-8">
  <title>GameStore</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Estilos inline para asegurar que el tema se aplique correctamente -->
  <style>
    /* Estilos base para tema claro */
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f5f5f7;
      color: #1a1a2e;
      transition: background-color 0.3s ease, color 0.3s ease;
    }
    
    /* Estilos para tema oscuro */
    html.dark-theme,
    body.dark-theme {
      background-color: #121212;
      color: #f5f5f7;
    }
    
    /* Estilos para tema claro */
    html.light-theme,
    body.light-theme {
      background-color: #f5f5f7;
      color: #1a1a2e;
    }
    
    /* Estilos de texto para modo oscuro */
    body.dark-theme p {
      color: #b0b0b0;
    }
    
    body.dark-theme h1,
    body.dark-theme h2,
    body.dark-theme h3,
    body.dark-theme h4,
    body.dark-theme h5,
    body.dark-theme h6 {
      color: #ffffff;
    }
    
    body.dark-theme a:not(.btn) {
      color: #ff6b8b;
    }
    
    /* Estilos de texto para modo claro */
    body.light-theme p {
      color: #fdfdfd;
    }
    
    body.light-theme h1,
    body.light-theme h2,
    body.light-theme h3,
    body.light-theme h4,
    body.light-theme h5,
    body.light-theme h6 {
      color: #ffffff;
    }
    
    body.light-theme a:not(.btn) {
      color: #e94560;
    }
  </style>
</head>
<body class="light-theme">
  <app-root></app-root>
  
  <!-- Botón de depuración para cambiar tema manualmente -->
  <div style="position: fixed; bottom: 20px; right: 20px; z-index: 9999;">
    <button onclick="toggleThemeManually()" style="padding: 10px; background: #e94560; color: white; border: none; border-radius: 4px; cursor: pointer;">
      Cambiar Tema Manualmente
    </button>
  </div>
  
  <script>
    // Función para cambiar el tema manualmente desde la consola o botón
    function toggleThemeManually() {
      const html = document.documentElement;
      const body = document.body;
      const currentTheme = html.classList.contains('dark-theme') ? 'dark' : 'light';
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      
      console.log(`Cambiando tema manualmente de ${currentTheme} a ${newTheme}`);
      
      if (newTheme === 'dark') {
        html.classList.remove('light-theme');
        html.classList.add('dark-theme');
        body.classList.remove('light-theme');
        body.classList.add('dark-theme');
        
        // Aplicar estilos directamente
        body.style.backgroundColor = '#121212';
        body.style.color = '#f5f5f7';
      } else {
        html.classList.remove('dark-theme');
        html.classList.add('light-theme');
        body.classList.remove('dark-theme');
        body.classList.add('light-theme');
        
        // Aplicar estilos directamente
        body.style.backgroundColor = '#f5f5f7';
        body.style.color = '#1a1a2e';
      }
      
      localStorage.setItem('theme', newTheme);
      console.log(`Tema cambiado a ${newTheme} y guardado en localStorage`);
      
      // Aplicar estilos a componentes clave
      applyThemeToComponents(newTheme);
      
      // Intentar notificar al servicio Angular (puede que no funcione directamente)
      try {
        const appRoot = document.querySelector('app-root');
        if (appRoot && appRoot.__ngContext__) {
          console.log('Intentando notificar al servicio Angular sobre el cambio de tema');
        }
      } catch (e) {
        console.log('No se pudo notificar al servicio Angular, recargar la página para sincronizar');
      }
    }
    
    // Aplicar estilos a componentes clave
    function applyThemeToComponents(theme) {
      // Aplicar estilos al header
      const header = document.querySelector('header');
      if (header) {
        if (theme === 'dark') {
          header.style.backgroundColor = '#0f0f1a';
        } else {
          header.style.backgroundColor = '#1a1a2e';
        }
      }
      
      // Aplicar estilos al footer
      const footer = document.querySelector('footer');
      if (footer) {
        if (theme === 'dark') {
          footer.style.backgroundColor = '#0f0f1a';
        } else {
          footer.style.backgroundColor = '#1a1a2e';
        }
      }
      
      // Aplicar estilos a las tarjetas de juegos
      const gameCards = document.querySelectorAll('.game-card');
      gameCards.forEach(card => {
        if (theme === 'dark') {
          card.style.backgroundColor = '#1e1e1e';
          card.style.color = '#f5f5f7';
          card.style.boxShadow = '0 4px 10px rgba(0, 0, 0, 0.3)';
        } else {
          card.style.backgroundColor = 'white';
          card.style.color = '#1a1a2e';
          card.style.boxShadow = '0 4px 10px rgba(0, 0, 0, 0.1)';
        }
      });
      
      // Aplicar estilos a los inputs
      const inputs = document.querySelectorAll('input, select, textarea');
      inputs.forEach(input => {
        if (theme === 'dark') {
          input.style.backgroundColor = '#2d2d2d';
          input.style.color = '#f5f5f7';
          input.style.borderColor = '#444444';
        } else {
          input.style.backgroundColor = 'white';
          input.style.color = '#1a1a2e';
          input.style.borderColor = '#dddddd';
        }
      });
      
      // Aplicar estilos a los textos
      applyTextStyles(theme);
    }
    
    // Aplicar estilos a textos
    function applyTextStyles(theme) {
      // Colores para modo oscuro
      const darkTextPrimary = '#f5f5f7';
      const darkTextSecondary = '#b0b0b0';
      const darkLinkColor = '#ff6b8b';
      const darkHeadingColor = '#ffffff';
      
      // Colores para modo claro
      const lightTextPrimary = '#1a1a2e';
      const lightTextSecondary = '#666666';
      const lightLinkColor = '#e94560';
      const lightHeadingColor = '#1a1a2e';
      
      // Aplicar estilos a párrafos
      const paragraphs = document.querySelectorAll('p');
      paragraphs.forEach(p => {
        if (theme === 'dark') {
          p.style.color = darkTextSecondary;
        } else {
          p.style.color = lightTextSecondary;
        }
      });
      
      // Aplicar estilos a títulos
      const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
      headings.forEach(heading => {
        if (theme === 'dark') {
          heading.style.color = darkHeadingColor;
        } else {
          heading.style.color = lightHeadingColor;
        }
      });
      
      // Aplicar estilos a enlaces
      const links = document.querySelectorAll('a:not(.btn)');
      links.forEach(link => {
        if (theme === 'dark') {
          link.style.color = darkLinkColor;
        } else {
          link.style.color = lightLinkColor;
        }
      });
      
      // Aplicar estilos a spans
      const spans = document.querySelectorAll('span:not(.cart-count)');
      spans.forEach(span => {
        if (!span.closest('button')) {
          if (theme === 'dark') {
            span.style.color = darkTextSecondary;
          } else {
            span.style.color = lightTextSecondary;
          }
        }
      });
    }
    
    // Verificar tema al cargar
    document.addEventListener('DOMContentLoaded', function() {
      const savedTheme = localStorage.getItem('theme');
      const html = document.documentElement;
      const body = document.body;
      
      console.log(`Tema guardado en localStorage: ${savedTheme}`);
      console.log(`Clases actuales en HTML: ${html.className}`);
      console.log(`Clases actuales en BODY: ${body.className}`);
      
      if (savedTheme === 'dark') {
        console.log('Aplicando tema oscuro desde localStorage');
        html.classList.remove('light-theme');
        html.classList.add('dark-theme');
        body.classList.remove('light-theme');
        body.classList.add('dark-theme');
        
        // Aplicar estilos directamente
        body.style.backgroundColor = '#121212';
        body.style.color = '#f5f5f7';
        
        // Aplicar estilos a componentes
        setTimeout(() => {
          applyThemeToComponents('dark');
        }, 500);
      }
    });
  </script>
</body>
</html>
